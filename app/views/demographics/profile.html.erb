
<!-- ========================= Show Profile Page Starts ========================= -->

<!-- Display Movies, Music, Books here -->

<%= content_for(:left_menu) do %>
    <% if params[:id].to_s != (current_user.id).to_s %>
        <%= render :partial=>"dashboards/left_menu_other" %>
    <% else %>
        <%= render :partial=>"dashboards/left_menu" %>
    <% end %>

<% end %>


<%= content_for(:dialogue_bar_header) do %>
    Your profile
<% end %>

<%= content_for(:page_header) do %>
    Profile
<% end %>



<style>


    /*.prof-demo-container{*/
    /*padding: 5%;*/
    /*}*/
</style>
<section id="view_profile_section" style="background-image: url('/assets/profile_back.jpg'); padding: 2% 5% 5% 2%;">
  <div class="row" >
    <div class="col-lg-9">
      <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
        <div class="row">
          <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
            <div class="blue name_text">

              <% if params[:id].to_s != (current_user.id).to_s %>
                  <%= @user_nick_name %>
              <% else %>
                  <b> <%= @user_name %> </b>
              <% end %>
            </div>
            <table style="color: white;">
              <tr>
                <td class="user_detail"><i class="fa fa-user"></i></td>
                <td class="user_detail"><%= "#{@user_gender}, #{@user_age}" %></td>
              </tr>
              <tr>
                <td class="user_detail"><i class="fa fa-flag"></i></td>
                <td class="user_detail"><%= @user_religion %></td>
              </tr>
              <tr>
                <td class="user_detail"><i class="fa fa-lightbulb-o"></i></td>
                <td class="user_detail"><%= @user.profession.name rescue "" %></td>
              </tr>
              <tr>
                <td class="user_detail"><i class="fa fa-globe"></i></td>
                <td class="user_detail"><%= @user.demographic.location %></td>
              </tr>
            </table>
          </div>
          <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
            <div class="col-xs-6 col-sm-6 col-md-6 col-lg-8 col-lg-offset-4">
              <div class="row">
                <div class="col-xs-3 col-sm-3 col-md-3 col-lg-5 col-lg-offset-1" style="background-color: #38C8E0;">
                  <div class="prof-demo-container">
                    <img src="/assets/whiteglass.png" alt="" class="img-responsive"/>

                    <p class="text-center"><%= @user_drinking %></p>
                  </div>
                </div>

                <div class="col-xs-3 col-sm-3 col-md-3 col-lg-5 col-lg-offset-1" style="background-color: #38C8E0;">
                  <div class="prof-demo-container">
                    <img src="/assets/whitesmokes.png" alt="" class="img-responsive"/>

                    <p class="text-center" style="margin-top: 1%;"><%= @user_smoking %></p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
            <h5 class="white" style="background-color: #38C8E0; padding: 2%; font-size: 1.3em;">About myself</h5>
          </div>
        </div>
        <div class="row">
          <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <p class="white"><%= @user_desc %></p>
          </div>
        </div>

        <!--<div class="row">-->
          <!--<div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">-->
            <!--<h5 class="white" style="background-color: #38C8E0; padding: 2%; font-size: 1.3em;">In next 5 years, I would be</h5>-->
          <!--</div>-->
        <!--</div>-->
        <!--<div class="row">-->
          <!--<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">-->
            <!--<p class="white"><%#= @user_goal %></p>-->
          <!--</div>-->
        <!--</div>-->

        <div class="row">
          <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
            <h5 class="white" style="background-color: #38C8E0; padding: 2%; font-size: 1.3em">Hobbies</h5>

            <div class="row">
              <div class="col-xs-4 col-sm-4 col-md-4 col-lg-5 white">
                <i class="fa fa-info-circle  font_awesome_icon blue"></i>
              </div>
              <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 white">
                <% current_user.hobby_lists.each do |h| %>
                    <div class="hd_list"><%= h.name %></div>
                    <% end %>
                <!--<div class="hd_list">Reading</div>-->
                <!--<div class="hd_list">Writing</div>-->
                <!--<div class="hd_list">Sleeping</div>-->
                <!--<div class="hd_list">Drinking</div>-->
                <!--<div class="hd_list">Movies</div>-->
              </div>
            </div>
          </div>
          <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
            <h5 class="white" style="background-color: #38C8E0; padding: 2%; font-size: 1.3em">How my friends Describe
              me</h5>

            <div class="row">
              <div class="col-xs-4 col-sm-4 col-md-4 col-lg-5 white">
                <i class="fa fa-comments font_awesome_icon blue"></i>
              </div>
              <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 white">
                <% current_user.about_lists.each do |h| %>
                    <div class="hd_list"><%= h.name %></div>
                <% end %>
                <!--<div class="hd_list">Artistic</div>-->

                <!--<div class="hd_list">Athletic</div>-->

                <!--<div class="hd_list">Emotinal</div>-->

                <!--<div class="hd_list">Sensitive</div>-->

                <!--<div class="hd_list">Sexy</div>-->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>



    <% if params[:id].to_s == (current_user.id).to_s %>
        <div class="col-lg-3">
      <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">

        <div class="row">
          <div class="profilometer_text">
            PROFILE'O' METER
          </div>
        </div>
        <br/>
        <div class="row">
          <div class="col-lg-12">
              <div class="knob_container">
                <!--<div id="myStat" data-dimension="200" data-text="35%" data-percent="46" data-info="" data-width="10" data-fontsize="38" data-percent="35" data-border="inline" data-fgcolor="#61a9dc" data-bgcolor="red" data-fill="#ddd" ></div>-->
                <div id="myStat" data-dimension="180" data-text="72%" data-info="" data-width="10" data-fontsize="48" data-percent="46" data-fgcolor="red" data-bgcolor="#eee" data-fill="#ddd" data-total="150" data-part="72" data-border="inline" data-icon="users" data-icon-size="28" data-icon-color="#ccc"></div>
              </div>
          <p class="white knob_text">Stating to look good!</p>
         </div>

        </div>
        <div class="row">
          <div class="col-lg-12 text-center">
            <a href="#"><i class="fa fa-envelope fa-3x white iconstyle" data-toggle="modal" data-target="#email_modal"></i></a>
            <p class="white invitefriend">Invite A Friend</p>
          </div>
        </div>

            <p id="edit_profile_text">
              <%= link_to 'Edit My Profile', edit_profile_path(current_user.id), :class => "blue" %>
            </p>

      </div>
    </div>
    <% else %>
        <div class="col-lg-3">
          <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <%= render :partial => "right_coffee_menu" %>
          </div>
        </div>
    <% end %>
  </div>



  <div class="modal fade" id="email_modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
          <h4 class="modal-title" id="myModalLabel" style="color: #000000">Invitee Your Friends</h4>
        </div>
        <div class="modal-body">
          <%= form_tag ('/invitee_friends') do %>
              <div class="row">
                <div class="col-lg-12">
                  <div class="row">
                    <div class="col-lg-12">
                      <%= label_tag "Enter Email" %>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-lg-12">
                      <%= text_field_tag :email, params[:email], :size => 50 %>
                    </div>
                  </div>
                </div>
              </div>
              </div>
              <div class="modal-footer">
                <div class="row">
                  <div class="col-lg-12">
                    <%= submit_tag "Send" %>
                  </div>
                </div>
          <% end %>
          <!--<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>-->
          <!--<button type="button" class="btn btn-primary">Save changes</button>-->
          </div>
          </div>
    </div>
  </div>

  <!--<div class="row">-->
    <!--<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">-->
      <!--<div class="ui-widget tag_style">-->
        <!--<p class="white">Search Movies :- </p>-->
        <!--<ul class="myTags">-->
          <!--<li>Tag1</li>-->
          <!--<li>Tag2</li>-->
        <!--</ul>-->
      <!--</div>-->
    <!--</div>-->
  <!--</div>-->

  <!--<div class="row">-->
    <!--<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">-->
      <!--<div class="ui-widget tag_style">-->
        <!--<p class="white">Search Music :- </p>-->
        <!--<ul class="myTags">-->
            <!--<li>Tag1</li>-->
          <!--<li>Tag2</li>-->
        <!--</ul>-->
      <!--</div>-->
    <!--</div>-->
  <!--</div>-->

  <!--<div class="row">-->
    <!--<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">-->
      <!--<div class="ui-widget tag_style">-->
        <!--<p class="white">Search Books :- </p>-->
        <!--<ul class="myTags">-->
          <!--<li>Tag1</li>-->
          <!--<li>Tag2</li>-->
        <!--</ul>-->
      <!--</div>-->
    <!--</div>-->
  <!--</div>-->



    <!-- keep this, don't delete - starts -->
    <!--<div class="row" style="padding-top: 3%;">-->
      <!--<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">-->
        <!--<div class="ui-widget">-->
          <!--<label for="movies">Search Movies :- </label>-->
          <!--<ul id="moviesTags">-->

          <!--</ul>-->
        <!--</div>-->


      <!--</div>-->
    <!--</div>-->
  <!-- keep this, don't delete - ends -->


</section>

<!-- ========================= Show Profile Page Ends ========================= -->
<!--<script src="/assets/gauge.min.js"></script>-->
<script>
  var moviesTags = [];
    $(function () {
        $(".myTags").tagit();

        console.log(moviesTags);

        call_auto_suggest_movies();
        $('#myStat').circliful();

//        $(".dial").knob();

        var availableTags = [
            "ActionScript",
            "AppleScript",
            "Asp",
            "BASIC",
            "C",
            "C++",
            "Clojure",
            "COBOL",
            "ColdFusion",
            "Erlang",
            "Fortran",
            "Groovy",
            "Haskell",
            "Java",
            "JavaScript",
            "Lisp",
            "Perl",
            "PHP",
            "Python",
            "Ruby",
            "Scala",
            "Scheme"
        ];

        var moviesJSON = [];
        var moviesName = [];

        //auto_complete_movie(moviesJSON);


        $('#movies_search_textfield').on('click', function(){
            auto_complete_movie(moviesJSON);
        });



        //https://github.com/tsechingho/chosen-rails
        var movie_search_text_field;
        movie_search_text_field = $('.chosen-container');
        var listing = $(movie_search_text_field).find('.chosen-drop').find('.chosen-results'); //results in chosen
        //console.log(listing);
        var movies_search_select_box = $("#movies_search_textfield"); // append <option>movie_name</option> in this

        //$(movie_search_text_field).find(":input").on('keyup', function (e) {
        $('#movies_search_textfield').on('keyup', function (e) {
            //console.log($(this).val());

            var movie_search_text = $(this).val();
            var movie_search_text_len = movie_search_text.length;
            console.log(movie_search_text + ", " + movie_search_text_len);

            //37 - left, 38 - up, 39 - right, 40 - down
            //if (e.keyCode == 37) {
            //alert( "left pressed" );
            //return false;
            //}

            // get keycode of current keypress event
            var code = (e.keyCode ? e.keyCode : e.which);

            // do nothing if it's an arrow key
            if (code == 37 || code == 38 || code == 39 || code == 40) {
                //$('.chosen-select').trigger("chosen:updated");
                return;
            }
            else {
                if ((movie_search_text_len >= 5)) {
                    //$(movies_search_select_box).html("");
                    moviesJSON = [];
                    var data = {movie_search_text: []};
                    data["movie_search_text"].push(movie_search_text);

                    $.ajax({
                        url: "/search_movies_themoviedb",
                        type: "post",
                        async: false,
                        data: JSON.stringify(data),
                        contentType: "application/json",
                        success: function (data) {
                            //console.log("data :- " + data);
                            var movie_name, movie_poster, movie_release_date, movie_id;
                            //$(movies_search_select_box).html("");
                            $.each(data, function (i, obj) {
                                //movie_name = obj.split("|||")[0];
                                movie_name = obj.title;
                                movie_id = obj.movie_id;
                                moviesJSON.push({"title":movie_name,"id":movie_id});
                                moviesName.push(movie_name);
                                console.log(moviesJSON);
                                //$(movies_search_select_box).append('<option value=' + i + '>' + movie_name + '</option>');
                                //<li class="active-result" style="" data-option-array-index="0">Read</li>
                                //$(listing).append('<li class="active-result" style="" data-option-array-index=' + i + '>' + movie_name + '</li>');
                                //$('.chosen-select').trigger("chosen:updated");
                                //$("#DropDownID").trigger("liszt:updated");
                                //$(movies_search_select_box).trigger("liszt:updated");
                            });
                            //$(movies_search_select_box).chosen();
                            auto_complete_movie(moviesName);
                            if ($("#movies_search_textfield").data('autocomplete')) {
                                jQuery.autocomplete("destroy");
                                jQuery.removeData('autocomplete');
                            }
                        }
                    });
                }
            }
        });


        $('#myTags').find('.ui-widget-content').on('keypress', function (e) {


            var music_search_text = $(this).val()
            var music_search_text_len = music_search_text.length;

            if ((music_search_text_len >= 5)) {
                var data = {music_search_text: []};
                data["music_search_text"].push(music_search_text);

                $.ajax({
                    url: "/search_music_db",
                    type: "post",
                    async: false,
                    data: JSON.stringify(data),
                    contentType: "application/json",
                    success: function (data) {
                        $.each(data, function (i, obj) {
//                        $('#myTags').find('.tagit-new').append(obj)
                        });

                    }
                });
            }

        })

        $('#moviesTags').find('.ui-widget-content').on('keyup', function (e) {


            var movies_search_text = $(this).val();
            var movies_search_text_len = movies_search_text.length;
            console.log(movies_search_text);

            if ((movies_search_text_len >= 5)) {
                var data = {movie_search_text: []};
                data["movie_search_text"].push(movies_search_text);

                $.ajax({
                    url: "/search_movies_themoviedb",
                    type: "post",
                    async: true,
                    data: JSON.stringify(data),
                    contentType: "application/json",
                    success: function (data) {
                        var movie_name, movie_id;
                        $.each(data, function (i, obj) {
                            movie_name = obj.title;
                            movie_id = obj.movie_id;
                            //console.log(movie_name, movie_id);
                            //$('#moviesTags').append(movie_name)
                            movie_name = obj.title;
                            movie_id = obj.movie_id;
                            moviesJSON.push({"title":movie_name,"id":movie_id});
                            moviesName.push(movie_name);
                            moviesTags.push(movie_name);
                            console.log("movietags :- " + moviesTags);
                            //console.log(moviesJSON, moviesName);
                        });
                        call_auto_suggest_movies();
                    }
                });
            }

        })


    });

    function auto_complete_movie(moviesJSON) {
        console.log("auto_complete_movie() called");
        $("#movies_search_textfield").autocomplete({
            source: moviesJSON
        });
    }

  function call_auto_suggest_movies(){
      console.log("called :- " + moviesTags);
      var availableTags = ["c", "java"];
      var mt = moviesTags;

      $("#moviesTags").tagit({
          allowSpaces: true,
          availableTags: mt,
          autocomplete: {
              delay: 0,
              minLength: 2,
              source : mt
          }
      });
  }


</script>
<!--http://rubygems.org/gems/rails4-autocomplete-->
<!--https://github.com/joliss/jquery-ui-rails-->